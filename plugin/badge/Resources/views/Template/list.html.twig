<ul class="nav nav-tabs" role="tablist">
    <li class="active">
        <a href="#badges" class="btn btn-default btn-md " title="{{ 'show_all_badges'|trans({}, 'icap_badge') }}" role="tab" data-toggle="tab">
            {{ 'show_all_badges'|trans({}, 'icap_badge') }}{% if 0 < claimPager|length %} <span class="badge badge-info" data-toggle="tooltip" data-container="body" title="{{ 'badge_current_claimed_badges_manage'|transchoice(claimPager|length, {'%claimedBadgeCount%': claimPager|length}, 'icap_badge') }}">
            {{ claimPager|length }}</span>{% endif %}
        </a>
    </li>
    <li>
        <a href="#users" class="btn btn-default btn-md" title="{{ 'list_by_user'|trans({}, 'icap_badge') }}" role="tab" data-toggle="tab">
            {{ 'list_by_user'|trans({}, 'icap_badge') }}{% if 0 < claimPager|length %} <span class="badge badge-info" data-toggle="tooltip" data-container="body" title="{{ 'badge_current_claimed_badges_manage'|transchoice(claimPager|length, {'%claimedBadgeCount%': claimPager|length}, 'icap_badge') }}">
                {{ claimPager|length }}</span>{% endif %}
        </a>
    </li>
    {% if parameters.badges_per_user is defined %}
    <li>
        <a href="#stats" class="btn btn-default btn-md" title="{{ 'badge_statistics'|trans({}, 'icap_badge') }}" role="tab" data-toggle="tab">
            <span class="fa fa-bar-chart"></span> {{ 'badge_statistics'|trans({}, 'icap_badge') }}
        </a>
        <!-- {{ path(parameters.statistics_link, parameters.route_parameters) }} -->
    </li>
    {% endif %}
</ul>

<!-- Tab panes -->
<div class="tab-content badge_tabs">
    <div class="tab-pane active" id="badges">
        <a href="{{ path(parameters.add_link, parameters.route_parameters) }}" title="{{ 'add_badge'|trans({}, 'icap_badge') }}" role="button" class="btn btn-primary btn-md">
            <span class="fa fa-plus"></span> {{ 'add_badge'|trans({}, 'icap_badge') }}
        </a>
        {% include 'IcapBadgeBundle:Template:list_badges.html.twig'%}
    </div>
    <div class="tab-pane" id="users">
        <a href="{{ path(parameters.csv_link, parameters.route_parameters) }}" role="button" class="btn btn-primary btn-md">
            <span class="fa fa-download"></span> {{ 'csv_export'|trans({}, 'icap_badge') }}
        </a>
        {% include 'IcapBadgeBundle:Template:list_badges_claim.html.twig'%}
        {% include 'IcapBadgeBundle:Template:list_users.html.twig'%}
    </div>
    {% if parameters.badges_per_user is defined%}
    <div class="tab-pane" id="stats">
        {% include 'IcapBadgeBundle:Template:statistics.html.twig'%}
    </div>
    {% endif %}
</div>

{% block javascripts %}
    <script> load({{ chunks('claroline-distribution-plugin-badge-list')|raw }}) </script>
    {% if parameters.badges_per_user is defined and parameters.badges_per_user is not empty and parameters.totalBadges > 0 %}
         <script type="text/javascript">
             window.s1 = [['{{ 'awarded_badges'|trans({}, 'icap_badge') }}',{{ parameters.totalBadgeAwarded }}], ['{{ 'availables_badges'|trans({}, 'icap_badge') }}',{{ parameters.totalBadgeNotAwarded }}]];
             window.badges_per_user = {{ parameters.badges_per_user|json_encode|raw }};
             window.mostAwarded =  [[ {% for awardedBadge in parameters.mostAwardedBadges %} ["{{ awardedBadge.userBadge.badge.name }}",{{ awardedBadge.awardedNumber }}],{% endfor %} ]]
         </script>
         <script> load({{ chunks('claroline-distribution-plugin-badge-template-list')|raw }}) </script>
     {% endif %}
{% endblock %}
