<div>
    <ul class="nav nav-tabs">
        <li id="general-tab-btn" class="active">
            <a href="#general-tab" data-toggle="tab">
                {{ "general"|trans:{}:'platform' }}
            </a>
        </li>
        <li ng-repeat="(key, facet) in fc.facets" id="tab-facet-{{ facet.id }}" ng-if="!facet.is_main">
            <a href="#facet-pane-{{ facet.id }}" data-toggle="tab">{{ facet.name }}
                <div class="dropdown">
                    <i class="fa fa-chevron-down pointer-hand" data-toggle="dropdown"></i>
                    <ul class="dropdown-menu" role="menu">
                        <li role="presentation"><i role="menuitem" ng-click="fc.onEditFacetFormRequest(facet)" class="fa fa-pencil"> {{ "edit"|trans:{}:'platform' }}</i></li>
                        <li role="presentation"><i role="menuitem" ng-click="fc.onDeleteFacet(facet)" class="fa fa-trash-o"> {{ "delete"|trans:{}:'platform' }}</i></li>
                        <li role="presentation"><i role="menuitem" ng-click="fc.onSetFacetRoles(facet)" class="fa fa-user"> {{ "roles"|trans:{}:'platform' }}</i></li>
                    </ul>
                </div>
            </a>
        </li>
        <li id="add-facet-btn">
            <a class="pointer-hand" ng-click="fc.onAddFacetFormRequest()">
                <i class="fa fa-plus"></i>
            </a>
        </li>
    </ul>
    <div id="facet-pane" class="tab-content">
        <div class="tab-pane active" id="general-tab">
            <div class="tab-pane active" id="general-tab">
                <div class="panel-heading"></div>
                <div class="panel-body">
                    <div>
                        <form method="post" ng-submit="fc.onSubmitProfilePreferences(formPreferences)" name="formPreferences">
                            <div class="well"> {{ 'general_tab_form_explanation'|trans:{}:'platform' }} </div>
                            <table class="table table-striped table-bordered table-condensed">
                                <thead>
                                <tr>
                                    <th> {{ 'role'|trans:{}:'platform' }} </th>
                                    <th> {{ 'base_informations'|trans:{}:'platform' }} </th>
                                    <th> {{ 'mail'|trans:{}:'platform' }} </th>
                                    <th> {{ 'phone'|trans:{}:'platform' }} </th>
                                    <th> {{ 'public_profile_preferences_allow_message_sending'|trans:{}:'platform' }} </th>
                                </tr>
                                </thead>
                                <tbody>
                                    <tr ng-repeat="(key, profilePreference) in fc.profilePreferences">
                                        <td> {{ profilePreference.role.translation_key|trans:{}:'platform' }}</td>
                                        <td> <form-checkbox field="fc.formProfilePreference.fields[0]" ng-model="profilePreference.base_data"> </form-checkbox> </td>
                                        <td> <form-checkbox field="fc.formProfilePreference.fields[1]" ng-model="profilePreference.mail"> </form-checkbox> </td>
                                        <td> <form-checkbox field="fc.formProfilePreference.fields[2]" ng-model="profilePreference.phone"> </form-checkbox> </td>
                                        <td> <form-checkbox field="fc.formProfilePreference.fields[3]" ng-model="profilePreference.send_message"> </form-checkbox> </td>
                                    </tr>
                                </tbody>
                            </table>
                            <input type="submit" class="btn btn-primary" value="{{ 'edit'|trans:{}:'platform' }}"></input>
                        </form>
                        <div ng-repeat="(key, facet) in fc.facets" id="tab-facet-{{ facet.id }}" ng-if="facet.is_main">
                            {{ facet.name }}
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div ng-repeat="(key, facet) in fc.facets" class="tab-pane" id="facet-pane-{{ facet.id }}" ng-if="!facet.is_main">
            <div class="panel-heading"></div>
            <div class="panel-body">
                <div class="panel-group" role="tablelist" aria-multiselectable="true">
                    <ul dragula='"panel-bag"' dragula-scope="$parent" dragula-model="facet.panels" data-facet-id="{{ facet.id }}">
                        <li ng-repeat="(key, panel) in facet.panels" id="panel-{{ panel.id }}" style="list-style-type: none;">
                            <div class="panel panel-default" id="panel-facet-main-{{ panel.id }}">
                                <div class="panel-heading" role="tab" id="facet-panel-{{ panel.id }}">
                                    <h4 class="panel-title">
                                        <div class="dropdown pull-left">
                                            <i class="fa fa-cog pointer-hand" data-toggle="dropdown"></i>
                                            <ul class="dropdown-menu" role="menu">
                                                <li role="presentation"><a href="#" ng-click="fc.onEditPanelFormRequest(panel)">{{ "edit"|trans:{}:'platform' }}</a></li>
                                                <li role="presentation"><a href="#" ng-click="fc.onSetPanelRoles(panel)"> {{ "roles"|trans:{}:'platform' }} </a>
                                                <li role="presentation"><a ng-click="fc.onAddFieldFormRequest(panel)" class="add-field-to-panel">{{ 'add_field_to_panel'|trans:{}:'platform' }}</a></li>
                                            </ul>
                                        </div>
                                        <a data-toggle="collapse" href="#panel-{{ panel.id }}" aria-expanded="true" aria-controls="panel-{{ panel.id}}" id="name-panel-{{ panel.id }}">
                                            {{ panel.name }}
                                        </a>
                                        <a href='#' class="pull-right" ng-click="fc.onDeletePanel(panel)"> x </a>
                                    </h4>
                                </div>
                                <div id="panel-{{ panel.id }}"
                                    class="panel-collapse collapse in"
                                    role="tabpanel"
                                    aria-labelledby="facet-panel-{{ panel.id }}"
                                >
                                    <div class="panel-body pointer" dragula='"field-bag"' dragula-scope="$parent" dragula-model="panel.fields">
                                        <div ng-repeat="(key, field) in panel.fields" class="list-group-item" data-panel-id="{{ panel.id }}}">
                                            <a ng-click="fc.onEditFieldFormRequest(field)" href="#">{{ field.name }} ({{ field.translation_key|trans:{}:'platform' }})</a>
                                            <a class="close" ng-click="fc.onDeleteField(field)" href="#" aria-hidden="true">&times;</a>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </li>
                    </ul>
                </div>
            </div>
            <div class="panel-footer pointer-hand text-center add-panel-to-facet" ng-click="fc.onAddPanelFormRequest(facet)">
                <i class="fa fa-plus-circle" data-facet-id="{{ facet.id }}"></i>
                {{ 'add_panel_to_facet'|trans:{}: 'platform' }}
            </div>
        </div>

    </div>
</div>
